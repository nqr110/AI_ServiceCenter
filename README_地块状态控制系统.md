# 金华市地块状态控制系统

## 功能概述

这是一个实时的地块状态管理系统，包含两个部分：

1. **主应用** (端口 5000) - 显示金华市 3D 地图
2. **后台管理** (端口 5005) - 控制地块状态

## 功能特点

- 🗺️ **3D 地图展示** - 金华市各地块的立体显示
- 🎨 **实时变色** - 地块状态变化时平滑变色
- 🔄 **实时同步** - 后台修改状态，前端立即更新
- 📱 **响应式设计** - 支持各种屏幕尺寸

## 地块状态

1. **正常状态** - 蓝色 (`#5698c3`)
2. **警告状态** - 黄色 (`#ffc107`)

## 安装和运行

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 启动系统

#### 方法一：使用启动脚本（推荐）

```bash
python start_servers.py
```

#### 方法二：分别启动两个服务器

终端 1 - 启动主应用：

```bash
python app.py
```

终端 2 - 启动后台管理：

```bash
python admin_server.py
```

### 3. 访问系统

- **主应用**: http://localhost:5000
- **后台管理**: http://localhost:5005

## 使用说明

### 后台管理操作

1. 打开后台管理页面 (http://localhost:5005)
2. 查看所有地块的当前状态
3. 点击"设为正常"或"设为警告"按钮切换状态
4. 前端地图会实时显示状态变化

### 前端地图功能

1. 打开主应用页面 (http://localhost:5000)
2. 查看 3D 地图展示
3. 地块会根据后台设置的状态自动变色
4. 支持鼠标旋转、缩放等交互操作

## 技术架构

### 后端技术

- **Flask** - Web 框架
- **Flask-SocketIO** - WebSocket 实时通信
- **Python** - 后端语言

### 前端技术

- **ECharts** - 3D 地图渲染
- **Socket.IO** - 实时通信客户端
- **HTML5/CSS3/JavaScript** - 前端界面

### 通信机制

- **WebSocket** - 实现后台管理和前端地图的实时同步
- **REST API** - 状态查询和更新接口

## 地块信息

| 代码 | 地名 | 说明         |
| ---- | ---- | ------------ |
| A 地 | A 市 | 主城区       |
| B 地 | B 市 | 新兴城区     |
| C 地 | C 市 | 纺织工业基地 |
| D 地 | D 市 | 商品贸易中心 |
| E 地 | E 市 | 影视名城     |
| F 地 | F 市 | 制造业之都   |
| G 地 | G 市 | 工艺之都     |
| H 地 | H 市 | 旅游胜地     |
| I 地 | I 市 | 生态之乡     |

## 注意事项

1. 确保 5000 和 5005 端口未被占用
2. 后台管理和前端需要同时运行才能实现实时同步
3. 建议使用 Chrome 或 Firefox 浏览器以获得最佳体验
4. 如果 WebSocket 连接失败，请检查防火墙设置

## 故障排除

### WebSocket 连接失败

- 检查后台管理服务器是否正常运行
- 确认端口 5005 未被占用
- 检查浏览器是否支持 WebSocket

### 地图显示异常

- 确认 ECharts 库加载成功
- 检查 GeoJSON 数据文件是否存在
- 查看浏览器控制台错误信息

### 状态更新不同步

- 确认 WebSocket 连接状态
- 检查网络连接
- 刷新页面重新建立连接
